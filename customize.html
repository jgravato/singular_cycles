<!DOCTYPE HTML>
<html>
  <head>
  <link href="css/demo.css" rel="stylesheet">
    <link href="css/unsemantic-grid-responsive-rtl.css" rel="stylesheet">
   <link href="css/custom.css" rel="stylesheet">
    <style>
      body {
        margin: 0px;
        padding: 0px;
      }
    </style>
  </head>
  <body onmousedown="return false;">
       <!-- Navigation -->
    <div id="nav">
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="customize.html">Customize</a></li>
        </ul>
    </div>
<!--End Navigation -->
    <div id="container"></div>
    <script src="http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v5.0.1.min.js"></script>
    <script>
      
        
    function update(activeAnchor) {
        var group = activeAnchor.getParent();

        var topLeft = group.find('.topLeft')[0];
        var topRight = group.find('.topRight')[0];
        var bottomRight = group.find('.bottomRight')[0];
        var bottomLeft = group.find('.bottomLeft')[0];
        var image = group.find('.image')[0];

        var anchorX = activeAnchor.x();
        var anchorY = activeAnchor.y();

        // update anchor position   
        switch (activeAnchor.name()) {
          case 'topLeft':
            topRight.y(anchorY);
            bottomLeft.x(anchorX);
            break;
          case 'topRight':
            topLeft.y(anchorY);
            bottomRight.x(anchorX);
            break;
          case 'bottomRight':
            bottomLeft.y(anchorY);
            topRight.x(anchorX); 
            break;
          case 'bottomLeft':
            bottomRight.y(anchorY);
            topLeft.x(anchorX); 
            break;
        }

        image.setPosition(topLeft.getPosition());

        var width = topRight.x() - topLeft.x();
        var height = bottomLeft.y() - topLeft.y();
        if(width && height) {
          image.setSize({width:width, height: height});
        }
      }
      function addAnchor(group, x, y, name) {
        var stage = group.getStage();
        var layer = group.getLayer();

        var anchor = new Kinetic.Circle({
          x: x,
          y: y,
          stroke: '#666',
          fill: '#ddd',
          strokeWidth: 0,
          radius: 0,
          name: name,
          draggable: true,
          dragOnTop: false
        });

        anchor.on('dragmove', function() {
          update(this);
          layer.draw();
        });
        anchor.on('mousedown touchstart', function() {
          group.setDraggable(false);
          this.moveToTop();
        });
        anchor.on('dragend', function() {
          group.setDraggable(true);
          layer.draw();
        });
        // add hover styling
        anchor.on('mouseover', function() {
          var layer = this.getLayer();
          document.body.style.cursor = 'pointer';
          this.setStrokeWidth(4);
          layer.draw();
        });
        anchor.on('mouseout', function() {
          var layer = this.getLayer();
          document.body.style.cursor = 'default';
          this.strokeWidth(2);
          layer.draw();
        });

        group.add(anchor);
      }
      function loadImages(sources, callback) {
        var images = {};
        var loadedImages = 0;
        var numImages = 0;
        for(var src in sources) {
          numImages++;
        }
        for(var src in sources) {
          images[src] = new Image();
          images[src].onload = function() {
            if(++loadedImages >= numImages) {
              callback(images);
            }
          };
          images[src].src = sources[src];
        }
      }
      function initStage(images) {
        var stage = new Kinetic.Stage({
          container: 'container',
          width: 1280,
          height: 1500
        });
        var greenBikeGroup = new Kinetic.Group({ //GreenBike
          x: 800,
          y: 100,
          draggable: true
        });
        var blueBikeGroup = new Kinetic.Group({ //BlueBike
          x: 800,
          y: 200,
          draggable: true
        });
        var purpleBikeGroup = new Kinetic.Group({ //purpleBike
          x: 800,
          y: 300,
          draggable: true
        });
        var redWheelGroup = new Kinetic.Group({ //red Wheel
          x: 50,
          y: 100,
          draggable: true
        });  
        var yellowWheelGroup = new Kinetic.Group({ //yellow Wheel
          x: 50,
          y: 200,
          draggable: true
        });
        var blueWheelGroup = new Kinetic.Group({ //blue Wheel
          x: 50,
          y: 300,
          draggable: true
        });  
        var layer = new Kinetic.Layer();

        /*
        add groups to layer, and layer to stage
         */
        
        layer.add(greenBikeGroup);
        layer.add(blueBikeGroup);
        layer.add(purpleBikeGroup); 
        layer.add(redWheelGroup); 
        layer.add(yellowWheelGroup);
        layer.add(blueWheelGroup);    
        stage.add(layer);

        // green bike------------
        
        var greenBikeImg = new Kinetic.Image({
          x: 0,
          y: 0,
          image: images.greenBike,
          width: 480,
          height: 320,
          name: 'image'
        });

        greenBikeGroup.add(greenBikeImg);
        addAnchor(greenBikeGroup, 0, 0, 'topLeft');
        addAnchor(greenBikeGroup, 200, 0, 'topRight');
        addAnchor(greenBikeGroup, 200, 138, 'bottomRight');
        addAnchor(greenBikeGroup, 0, 138, 'bottomLeft');

        greenBikeGroup.on('dragstart', function() {
          this.moveToTop();
        });
        
        // red wheel------------
        
        var redWheelImg = new Kinetic.Image({
          x: 0,
          y: 0,
          image: images.redWheel,
          width: 450.4,
          height: 182,
          name: 'image'
        });

        redWheelGroup.add(redWheelImg);
        addAnchor(redWheelGroup, 0, 0, 'topLeft');
        addAnchor(redWheelGroup, 200, 0, 'topRight');
        addAnchor(redWheelGroup, 200, 138, 'bottomRight');
        addAnchor(redWheelGroup, 0, 138, 'bottomLeft');

        redWheelGroup.on('dragstart', function() {
          this.moveToTop();
        });
        
        // yellow wheel------------
        
        var yellowWheelImg = new Kinetic.Image({
          x: 0,
          y: 0,
          image: images.yellowWheel,
          width: 450.4,
          height: 182,
          name: 'image'
        });

        yellowWheelGroup.add(yellowWheelImg);
        addAnchor(yellowWheelGroup, 0, 0, 'topLeft');
        addAnchor(yellowWheelGroup, 200, 0, 'topRight');
        addAnchor(yellowWheelGroup, 200, 138, 'bottomRight');
        addAnchor(yellowWheelGroup, 0, 138, 'bottomLeft');

        yellowWheelGroup.on('dragstart', function() {
          this.moveToTop();
        });
        
        // blue wheel------------
        
        var blueWheelImg = new Kinetic.Image({
          x: 0,
          y: 0,
          image: images.blueWheel,
          width: 450.4,
          height: 182,
          name: 'image'
        });

        blueWheelGroup.add(blueWheelImg);
        addAnchor(blueWheelGroup, 0, 0, 'topLeft');
        addAnchor(blueWheelGroup, 200, 0, 'topRight');
        addAnchor(blueWheelGroup, 200, 138, 'bottomRight');
        addAnchor(blueWheelGroup, 0, 138, 'bottomLeft');

        blueWheelGroup.on('dragstart', function() {
          this.moveToTop();
        });  
        // purple bike-----------
        
        var purpleBikeImg = new Kinetic.Image({
          x: 0,
          y: 0,
          image: images.purpleBike,
          width: 480,
          height: 320,
          name: 'image'
        });

        purpleBikeGroup.add(purpleBikeImg);
        addAnchor(purpleBikeGroup, 0, 0, 'topLeft');
        addAnchor(purpleBikeGroup, 200, 0, 'topRight');
        addAnchor(purpleBikeGroup, 200, 138, 'bottomRight');
        addAnchor(purpleBikeGroup, 0, 138, 'bottomLeft');

        purpleBikeGroup.on('dragstart', function() {
          this.moveToTop();
        });
        
        // blue bike ------------
        
        var blueBikeImg = new Kinetic.Image({
          x: 0,
          y: 0,
          image: images.blueBike,
          width: 480,
          height: 320,
          name: 'image'
        });

        blueBikeGroup.add(blueBikeImg);
        addAnchor(blueBikeGroup, 0, 0, 'topLeft');
        addAnchor(blueBikeGroup, 93, 0, 'topRight');
        addAnchor(blueBikeGroup, 93, 104, 'bottomRight');
        addAnchor(blueBikeGroup, 0, 104, 'bottomLeft');

        blueBikeGroup.on('dragstart', function() {
          this.moveToTop();
        });

        stage.draw();
      }

      var sources = {
        greenBike: 'http://sulley.cah.ucf.edu/~jo795082/singular_cycles/green_frame.png',
        purpleBike: 'http://sulley.cah.ucf.edu/~jo795082/singular_cycles/purple_frame.png',
        blueBike: 'http://sulley.cah.ucf.edu/~jo795082/singular_cycles/blue_frame.png',
        redWheel: 'http://sulley.cah.ucf.edu/~jo795082/singular_cycles/red_wheels.png',
        yellowWheel: 'http://sulley.cah.ucf.edu/~jo795082/singular_cycles/yellow_wheels.png',
        blueWheel: 'http://sulley.cah.ucf.edu/~jo795082/singular_cycles/blue_wheels.png'  
      };
      loadImages(sources, initStage);

    </script>
  
  </body>
</html>      